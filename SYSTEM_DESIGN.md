# 뉴스 요약 및 감정 분석 챗봇 시스템 설계서

## 1. 프로젝트 개요

### 1.1 목적
- 뉴스 URL을 입력받아 본문을 자동 추출
- Hugging Face 모델을 활용한 뉴스 요약
- 감정 분석을 통한 긍정/부정/중립 판단
- 대화형 인터페이스로 사용자 경험 향상

### 1.2 주요 기능
| 기능 | 설명 |
|------|------|
| 뉴스 크롤링 | URL에서 뉴스 본문 자동 추출 |
| 텍스트 요약 | KoBART 모델로 핵심 내용 요약 |
| 감정 분석 | 긍정/부정/중립 분류 및 신뢰도 점수 |
| 키워드 추출 | 주요 키워드 자동 추출 |
| 대화형 질의 | 뉴스 내용에 대한 Q&A |

---

## 2. 시스템 아키텍처

```
┌─────────────────────────────────────────────────────────────────┐
│                        Streamlit UI                              │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐          │
│  │  URL 입력    │  │  요약 결과   │  │  감정 분석   │          │
│  │  컴포넌트    │  │  표시 영역   │  │  시각화      │          │
│  └──────────────┘  └──────────────┘  └──────────────┘          │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│                      Backend Services                            │
│  ┌──────────────────────────────────────────────────────────┐  │
│  │                    News Processor                         │  │
│  │  ┌────────────┐  ┌────────────┐  ┌────────────┐         │  │
│  │  │  Crawler   │  │ Summarizer │  │  Analyzer  │         │  │
│  │  │  Service   │  │  Service   │  │  Service   │         │  │
│  │  └────────────┘  └────────────┘  └────────────┘         │  │
│  └──────────────────────────────────────────────────────────┘  │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│                    Hugging Face Models                           │
│  ┌──────────────────┐  ┌──────────────────┐                    │
│  │  KoBART          │  │  Korean          │                    │
│  │  Summarization   │  │  Sentiment       │                    │
│  │  Model           │  │  Analysis Model  │                    │
│  └──────────────────┘  └──────────────────┘                    │
└─────────────────────────────────────────────────────────────────┘
```

---

## 3. 기술 스택

### 3.1 Frontend
| 구성요소 | 기술 | 버전 |
|----------|------|------|
| UI Framework | Streamlit | 1.29+ |
| Visualization | Plotly | 5.18+ |
| Styling | streamlit-extras | latest |

### 3.2 Backend
| 구성요소 | 기술 | 버전 |
|----------|------|------|
| Language | Python | 3.10+ |
| ML Framework | Transformers | 4.36+ |
| Web Scraping | newspaper3k, BeautifulSoup4 | latest |
| HTTP Client | requests | 2.31+ |

### 3.3 Hugging Face 모델
| 용도 | 모델 | 설명 |
|------|------|------|
| 텍스트 요약 | `gogamza/kobart-summarization` | 한국어 뉴스 요약에 최적화된 KoBART |
| 감정 분석 | `snunlp/KR-FinBert-SC` | 한국어 감정 분류 (긍정/부정/중립) |
| 키워드 추출 | `KeyBERT` + `ko-sentence-transformers` | 한국어 키워드 추출 |

---

## 4. 데이터 흐름

```
[사용자]
    │
    ▼ (1) 뉴스 URL 입력
[Streamlit UI]
    │
    ▼ (2) URL 전달
[Crawler Service]
    │ - newspaper3k로 본문 추출
    │ - 제목, 본문, 작성일, 이미지 추출
    │
    ▼ (3) 추출된 텍스트
[Summarizer Service]
    │ - KoBART 모델로 요약 생성
    │ - 3줄 요약 생성
    │
    ▼ (4) 요약 텍스트
[Sentiment Analyzer]
    │ - 감정 분석 수행
    │ - 긍정/부정/중립 분류
    │ - 신뢰도 점수 계산
    │
    ▼ (5) 분석 결과
[Keyword Extractor]
    │ - 주요 키워드 5개 추출
    │
    ▼ (6) 최종 결과
[Streamlit UI] → [사용자에게 표시]
```

---

## 5. 프로젝트 구조

```
miniproject02/
├── app.py                      # Streamlit 메인 앱
├── requirements.txt            # 의존성 패키지
├── .env                        # 환경 변수 (선택)
├── README.md                   # 프로젝트 설명
│
├── services/                   # 비즈니스 로직
│   ├── __init__.py
│   ├── crawler.py              # 뉴스 크롤링 서비스
│   ├── summarizer.py           # 텍스트 요약 서비스
│   ├── sentiment.py            # 감정 분석 서비스
│   └── keywords.py             # 키워드 추출 서비스
│
├── models/                     # 모델 관련
│   ├── __init__.py
│   └── model_loader.py         # Hugging Face 모델 로더
│
├── utils/                      # 유틸리티
│   ├── __init__.py
│   ├── text_processor.py       # 텍스트 전처리
│   └── validators.py           # URL 검증 등
│
├── components/                 # Streamlit 컴포넌트
│   ├── __init__.py
│   ├── sidebar.py              # 사이드바 컴포넌트
│   ├── result_display.py       # 결과 표시 컴포넌트
│   └── charts.py               # 차트 컴포넌트
│
└── tests/                      # 테스트
    ├── __init__.py
    ├── test_crawler.py
    ├── test_summarizer.py
    └── test_sentiment.py
```

---

## 6. API 설계 (내부 서비스)

### 6.1 Crawler Service
```python
class CrawlerService:
    def extract_article(url: str) -> ArticleData:
        """
        뉴스 URL에서 기사 정보 추출

        Returns:
            ArticleData:
                - title: str (기사 제목)
                - content: str (기사 본문)
                - date: datetime (작성일)
                - image_url: str (대표 이미지)
                - source: str (언론사)
        """
```

### 6.2 Summarizer Service
```python
class SummarizerService:
    def summarize(text: str, max_length: int = 150) -> SummaryResult:
        """
        텍스트 요약 수행

        Returns:
            SummaryResult:
                - summary: str (요약문)
                - original_length: int (원문 길이)
                - summary_length: int (요약문 길이)
                - compression_ratio: float (압축률)
        """
```

### 6.3 Sentiment Service
```python
class SentimentService:
    def analyze(text: str) -> SentimentResult:
        """
        감정 분석 수행

        Returns:
            SentimentResult:
                - label: str ("긍정" | "부정" | "중립")
                - confidence: float (0.0 ~ 1.0)
                - scores: dict (각 라벨별 점수)
        """
```

### 6.4 Keyword Service
```python
class KeywordService:
    def extract(text: str, top_k: int = 5) -> List[KeywordResult]:
        """
        키워드 추출

        Returns:
            List[KeywordResult]:
                - keyword: str (키워드)
                - score: float (중요도 점수)
        """
```

---

## 7. UI 설계

### 7.1 메인 화면 레이아웃
```
┌────────────────────────────────────────────────────────────┐
│  📰 뉴스 요약 & 감정 분석 챗봇                    [설정]   │
├────────────────────────────────────────────────────────────┤
│                                                            │
│  🔗 뉴스 URL 입력                                          │
│  ┌──────────────────────────────────────┐  ┌────────┐    │
│  │ https://news.example.com/article... │  │ 분석   │    │
│  └──────────────────────────────────────┘  └────────┘    │
│                                                            │
├────────────────────────────────────────────────────────────┤
│                                                            │
│  📄 원문 정보                                              │
│  ┌──────────────────────────────────────────────────────┐│
│  │ 제목: [기사 제목]                                    ││
│  │ 언론사: [언론사명]  |  작성일: [2024-01-01]          ││
│  └──────────────────────────────────────────────────────┘│
│                                                            │
│  ┌─────────────────────┐  ┌─────────────────────────────┐│
│  │ 📝 요약 결과        │  │ 📊 감정 분석               ││
│  │                     │  │                             ││
│  │ • 요약 문장 1       │  │  [====긍정====]  75%       ││
│  │ • 요약 문장 2       │  │  [==부정==]      15%       ││
│  │ • 요약 문장 3       │  │  [=중립=]        10%       ││
│  │                     │  │                             ││
│  │ 압축률: 85%         │  │  판정: 긍정적 기사         ││
│  └─────────────────────┘  └─────────────────────────────┘│
│                                                            │
│  🏷️ 주요 키워드                                           │
│  ┌──────────────────────────────────────────────────────┐│
│  │  #경제  #주식  #투자  #금리  #정책                   ││
│  └──────────────────────────────────────────────────────┘│
│                                                            │
├────────────────────────────────────────────────────────────┤
│  💬 기사에 대해 질문하기                                   │
│  ┌──────────────────────────────────────┐  ┌────────┐    │
│  │ 이 기사의 핵심 내용이 뭐야?         │  │ 전송   │    │
│  └──────────────────────────────────────┘  └────────┘    │
│                                                            │
│  🤖 [챗봇 응답 영역]                                       │
│                                                            │
└────────────────────────────────────────────────────────────┘
```

### 7.2 사이드바
```
┌──────────────────────┐
│  ⚙️ 설정             │
├──────────────────────┤
│                      │
│  요약 길이           │
│  [====|====] 150자   │
│                      │
│  키워드 개수         │
│  [  5  ] ▼           │
│                      │
│  ──────────────────  │
│                      │
│  📜 분석 히스토리    │
│  • 기사 1 (14:30)    │
│  • 기사 2 (14:25)    │
│  • 기사 3 (14:20)    │
│                      │
│  ──────────────────  │
│                      │
│  ℹ️ 모델 정보        │
│  요약: KoBART        │
│  감정: KR-FinBert    │
│                      │
└──────────────────────┘
```

---

## 8. 성능 최적화 전략

### 8.1 모델 로딩
- **캐싱**: `@st.cache_resource`로 모델 한 번만 로딩
- **지연 로딩**: 필요할 때만 모델 로드

### 8.2 처리 속도
- **비동기 처리**: 크롤링과 분석 병렬 처리
- **텍스트 청킹**: 긴 텍스트는 분할 처리

### 8.3 메모리 관리
- **GPU 활용**: CUDA 사용 가능 시 GPU 활용
- **배치 처리**: 여러 요청 배치 처리

---

## 9. 에러 처리

| 에러 상황 | 처리 방법 |
|-----------|-----------|
| 잘못된 URL | 유효성 검사 후 사용자 알림 |
| 크롤링 실패 | 대체 크롤러 시도 또는 에러 메시지 |
| 모델 로딩 실패 | 재시도 로직 + 폴백 모델 |
| 텍스트 너무 김 | 자동 분할 처리 |
| API 제한 | 요청 제한 및 큐잉 |

---

## 10. 향후 확장 계획

1. **다국어 지원**: 영어, 일본어 뉴스 분석 추가
2. **히스토리 저장**: SQLite로 분석 기록 저장
3. **트렌드 분석**: 특정 주제의 감정 변화 추적
4. **API 제공**: FastAPI로 REST API 추가
5. **배포**: Hugging Face Spaces 또는 Streamlit Cloud 배포

---

## 11. 개발 일정 (예상)

| 단계 | 작업 내용 |
|------|-----------|
| Phase 1 | 프로젝트 셋업, 기본 구조 생성 |
| Phase 2 | 크롤링 서비스 구현 |
| Phase 3 | 요약 모델 통합 |
| Phase 4 | 감정 분석 모델 통합 |
| Phase 5 | Streamlit UI 구현 |
| Phase 6 | 테스트 및 최적화 |
| Phase 7 | 배포 |
